# 🌐 `std::cout`로 유니코드(UTF‑8) 출력하기

C++에서 콘솔에 **한글, 이모지** 같은 유니코드 문자를 제대로 출력하는 방법을 OS별로 정리했습니다.  
핵심 포인트는 **소스 인코딩(UTF‑8)**, **런타임 출력 인코딩(UTF‑8)**, **터미널 폰트/로케일** 3가지를 맞추는 것입니다.

---

## ✅ 한눈에 요약

| OS | 소스 인코딩 | 런타임 설정 | 터미널/추가 팁 |
|---|---|---|---|
| Linux / macOS | UTF‑8 | 보통 추가 설정 없이 OK | 로케일이 `UTF-8`인지 확인(`locale`) |
| Windows (MSVC) | `/utf-8` | `SetConsoleOutputCP(CP_UTF8); SetConsoleCP(CP_UTF8);` | Windows Terminal 권장, 폰트가 이모지 지원해야 함 |

> **항상** 소스 파일을 **UTF‑8 (BOM 없이)** 로 저장하는 것을 권장합니다. (MSVC는 BOM 유무 상관없이 `/utf-8` 사용 시 안전)

---

## 🐧 Linux / 🍎 macOS

대부분 터미널 기본 인코딩이 **UTF‑8**이므로 아래 코드만으로 충분합니다.

```cpp
#include <iostream>
#include <locale>

int main() {
  std::locale::global(std::locale("")); // 시스템 로케일(대개 UTF-8)
  std::cout.imbue(std::locale());       // 스트림에 로케일 적용(선택)
  std::cout << u8"한글 + 😀\n";          // 소스 파일을 UTF-8로 저장
}
```

### 빌드 팁
- GCC/Clang 기본은 소스 UTF‑8 인식이지만, 필요하다면:
  - `-finput-charset=UTF-8 -fexec-charset=UTF-8`
- 터미널 로케일이 UTF‑8인지 확인: `locale` 출력에 `UTF-8` 포함되어야 함.

---

## 🪟 Windows (MSVC)

### 방법 A — `std::cout` + 콘솔 코드페이지를 UTF‑8로
```cpp
#include <windows.h>
#include <iostream>

int main() {
  SetConsoleOutputCP(CP_UTF8);
  SetConsoleCP(CP_UTF8);
  std::cout << u8"한글 + 😀\n";
}
```

- **컴파일 옵션**: `/utf-8` (소스/실행 문자셋을 UTF‑8로)
- **터미널**: Windows Terminal / PowerShell 권장. 기본 `cmd.exe`는 환경에 따라 `chcp 65001`이 필요할 수 있습니다.
- **폰트**: 원하는 글리프(한글/이모지)를 포함한 폰트를 선택해야 올바르게 렌더링됩니다.

### (참고) 방법 B — wide I/O 사용 (`std::wcout`)
일부 환경에서는 wide 출력이 더 안정적일 수 있습니다.
```cpp
#include <windows.h>
#include <iostream>
#include <io.h>
#include <fcntl.h>

int main() {
  // 콘솔을 UTF-8 코드페이지로, 표준 스트림을 UTF-16LE 텍스트 모드로 전환
  SetConsoleOutputCP(CP_UTF8);
  _setmode(_fileno(stdout), _O_U16TEXT); // Windows 전용
  std::wcout << L"한글 + 😀\n";
}
```
> wide 방식은 Windows 콘솔에서만 권장됩니다. 교차 플랫폼 코드라면 **방법 A**(UTF‑8)로 통일하는 것이 낫습니다.

---

## 🔍 트러블슈팅

- **깨진 글자(�, 물음표)**:  
  1) 소스 파일이 UTF‑8인지 확인, 2) 런타임 출력 인코딩(코드페이지/로케일)이 UTF‑8인지 확인, 3) 터미널 폰트가 글리프를 지원하는지 확인.
- **이모지가 네모 상자로 보임**: 폰트가 이모지 글리프를 포함한 폰트인지 확인 (예: Windows Terminal에서 `Cascadia Code PL`+ 컬러 이모지 폰트).
- **MSVC에서 한글 리터럴 경고/깨짐**: `/utf-8` 옵션을 사용하세요.
- **기본 cmd에서 여전히 깨짐**: `chcp 65001` 후 실행하거나 Windows Terminal 사용.

---

## 🧪 가장 단순한 교차 플랫폼 예제

```cpp
#include <iostream>

int main() {
  // 소스 파일을 UTF-8로 저장하고, 각 OS 가이드대로 콘솔/터미널을 UTF-8로 설정하면 OK
  std::cout << u8"안녕하세요 👋  UTF-8 테스트!\n";
}
```

> 프로젝트 전역으로 **UTF‑8 고정**(MSVC `/utf-8`) + **UTF‑8 콘솔**을 습관화하면, 운영체제에 상관없이 대부분 문제없이 출력됩니다.

---

