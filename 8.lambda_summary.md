
# C++11 ëŒë‹¤(Lambda) ì •ë¦¬

C++11ì—ì„œ **ëŒë‹¤(lambda)**ëŠ” ìµëª… í•¨ìˆ˜(Anonymous Function)ë¥¼ ë§Œë“œëŠ” ìƒˆë¡œìš´ ë¬¸ë²•ì…ë‹ˆë‹¤.  
ëŒë‹¤ëŠ” ì´ë¦„ì´ ì—†ëŠ” í•¨ìˆ˜ì´ë©°, **STL í•¨ìˆ˜ ê°ì²´(Functor)**ì²˜ëŸ¼ ë™ì‘í•©ë‹ˆë‹¤.



### ğŸ“Œ ëŒë‹¤ ê¸°ë³¸ êµ¬ì¡° ê·¸ë¦¼
![ëŒë‹¤êµ¬ì¡°](/image/lambda.png)


---

## 1. ëŒë‹¤ì˜ ê¸°ë³¸ êµ¬ì¡°

```cpp
[capture](parameter_list) mutable -> return_type {
    // body
}
```

| êµ¬ì„± ìš”ì†Œ | ì„¤ëª… |
|-----------|------|
| **[capture]** | ì™¸ë¶€ ë³€ìˆ˜ ìº¡ì²˜ ë°©ì‹ ì§€ì • |
| **(parameter_list)** | ë§¤ê°œë³€ìˆ˜ ëª©ë¡ |
| **mutable** | ê°’ ìº¡ì²˜ ì‹œ ë‚´ë¶€ ë³€ìˆ˜ ë³€ê²½ í—ˆìš© |
| **-> return_type** | ë°˜í™˜ íƒ€ì… ì§€ì • |
| **{ body }** | í•¨ìˆ˜ ë³¸ë¬¸ |

---

## 2. ìº¡ì²˜(Capture)

ëŒë‹¤ëŠ” ì™¸ë¶€ ìŠ¤ì½”í”„ ë³€ìˆ˜ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ìº¡ì²˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

| êµ¬ë¬¸ | ì„¤ëª… |
|------|------|
| `[=]` | ëª¨ë“  ì™¸ë¶€ ë³€ìˆ˜ë¥¼ ê°’(value)ìœ¼ë¡œ ìº¡ì²˜ |
| `[&]` | ëª¨ë“  ì™¸ë¶€ ë³€ìˆ˜ë¥¼ ì°¸ì¡°(reference)ë¡œ ìº¡ì²˜ |
| `[a, &b]` | aëŠ” ê°’, bëŠ” ì°¸ì¡°ë¡œ ìº¡ì²˜ |
| `[=, &a]` | aë§Œ ì°¸ì¡°, ë‚˜ë¨¸ì§€ëŠ” ê°’ |
| `[&, a]` | aë§Œ ê°’, ë‚˜ë¨¸ì§€ëŠ” ì°¸ì¡° |

**ì˜ˆì‹œ:**

```cpp
int a = 1, b = 2;

[=]() { std::cout << a << b; }();   // ê°’ ë³µì‚¬
[&]() { b = 10; }();               // ì°¸ì¡°ë¡œ ìˆ˜ì • ê°€ëŠ¥
```

```cpp
int main(){
    sum(10,10);
    int c = [](int a, int b){
        std::cout<< "Sum:" << a+b <<std::endl;
        return a + b;
    }(30,40);

    std::cout << c << std::endl;
    
    auto ret = [](int a,int b){
        std::cout<< "Sum:" << a+b <<std::endl;
        return std::tuple<int,int,int>{a,b,a+b};
    }(30,40);

    int a = std::get<0>(ret);
    int b = std::get<1>(ret);
    int c = std::get<2>(ret);

    std::cout<< a << "," << b << "," << c <<std::endl;

    int result1 = 1;
    int result2 = 2;
    int result3 = 3;
    int result4 = 4;

    //ë³€ìˆ˜ë³µì‚¬
    [result1, result2](int a, int b){
        std::cout<<"Result:"<< result1 + result2 <<std::endl;
    }(10,20);


    //ë³€ìˆ˜ì°¸ì¡°
    [&result3, &result4](inta,intb){
        std::cout<< "Result:" << result3 + result4 <<std::endl;
        result3 = 100;
        result4 = 200;
    }(10,20);

    //ì „ì²´ë³µì‚¬
    [=](int x){
        std::cout<<"Result1,2"<<result1<<","<<result2<<std::endl;
        std::cout<<"Result3,4"<<result3<<","<<result4<<std::endl;
    }(30);
    

    //ì „ì²´ì°¸ì¡°
    [&](int x){
        result1 = 10;
        result2 = 20;
        result3 = 30;
        result4 = 40;
        std::cout<<"Result1,2"<< result1 <<","<< result2 <<std::endl;
        std::cout<<"Result3,4"<< result3 <<","<< result4 <<std::endl;
    }(30);

    std::cout<<"Result1,2"<<result1<<","<<result2<<std::endl;
    std::cout<<"Result3,4"<<result3<<","<<result4<<std::endl;

    //ì „ì²´ë³µì‚¬ ì¼ë¶€ì°¸ì¡°
    [=,&result3,&result4](intx){
        //result1=10;
        //result2=20;
        result3=30;
        result4=40;
        std::cout<<"Result1,2"<<result1<<","<<result2<<std::endl;
        std::cout<<"Result3,4"<<result3<<","<<result4<<std::endl;
    }(30);
    return0;
}
```



---

## 3. mutable í‚¤ì›Œë“œ

ê°’(value) ìº¡ì²˜ ì‹œ, ê¸°ë³¸ì ìœ¼ë¡œ ë³€ìˆ˜ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.  
`mutable`ì„ ì‚¬ìš©í•˜ë©´ ëŒë‹¤ ë‚´ë¶€ì—ì„œ ê°’ ìº¡ì²˜ ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```cpp
int x = 10;
[=]() mutable { x = 20; }(); // ë‚´ë¶€ì—ì„œ ìˆ˜ì • ê°€ëŠ¥ (ì™¸ë¶€ ê°’ì—ëŠ” ì˜í–¥ ì—†ìŒ)
```

---

## 4. ì˜ˆì™¸ ëª…ì‹œ (throw)

ëŒë‹¤ ë’¤ì— `throw()`ë¥¼ ë¶™ì´ë©´ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•Šê² ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

```cpp
[]() throw() { /* ì˜ˆì™¸ ì—†ìŒ */ };

[]() throw(int) { throw 42; }; // int ì˜ˆì™¸ ê°€ëŠ¥
```

---

## 5. ë°˜í™˜ íƒ€ì…(Return Type)

`-> íƒ€ì…` í˜•íƒœë¡œ ë°˜í™˜ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```cpp
auto sum = [](int a, int b) -> int { return a + b; };
```

ë°˜í™˜ íƒ€ì…ì„ ìƒëµí•˜ë©´ `return`ë¬¸ì˜ íƒ€ì…ì„ ì¶”ë¡ í•©ë‹ˆë‹¤.

---

## 6. std::functionê³¼ ëŒë‹¤

ëŒë‹¤ëŠ” `std::function`ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ ê³ ì°¨ í•¨ìˆ˜(Higher-order function) êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```cpp
#include <functional>
std::function<int(int)> f = [](int x) { return x + 1; };
```

---

## 7. í•¨ìˆ˜ ì¸ìë¡œ ëŒë‹¤ ì „ë‹¬

```cpp
#include <algorithm>
#include <vector>

std::vector<int> v = {5, 2, 8, 1};
std::sort(v.begin(), v.end(), [](int a, int b) {
    return a < b;
});
```
---

---

## 8. Function ê³¼ ì—°ë™

```cpp
#include <functional>
int foo_return(int para) {
    return para;
}

int lambda_test4() {
// std::function wraps a function that take int parameter and returns int value
    std::function<int(int)> func = foo_return;

    int important = 10;
    std::function<int(int)> func2 = [&](int value) -> int {
        return 1 + value + important;
    };
    
    std::cout << func(10) << std::endl;
    std::cout << func2(10) << std::endl;
}

#include <iostream>
#include <functional>

std::function<int(int)> retFunc (int& a) {
    return [&a](int b) {
        return a+b;
    };
}

int main() {
    int a = 20;
    std::function<int(int)> ret = retFunc(a);
    std::cout << ret(10) << std::endl;
    //30
    a = 40;
    std::cout << ret(10) << std::endl;
    //50
    return 0;
}


//ëŒë‹¤ì‹ì„ í•¨ìˆ˜ ì „ë‹¬ì— ì‹¤ìš©ì ìœ¼ë¡œ ì“°ëŠ” ë°©ë²•
#include <iostream>
typedef int (*func) (int a, int b);
void funCall(func f, int a, int b) {
    std::cout << f(a, b) << std::endl;
}
int add(int a, int b) { return a + b; }
int sub(int a, int b) { return a - b; }
void main() {
    int a = 1;
    int b = 2;
    funCall([](int a, int b) -> int{ return a + b; }, a, b);
    func funAdd = add;
    func funSub = sub;
    funCall(funAdd, a, b);
    funCall(funSub, a, b);
}


#include <iostream>
typedef int (*func) (int a, int b);
func getFunction(std::string name) {
    if (name == "add") {
        return [](int a, int b)->int {return a + b;};
    }
    else if (name == "sub") {
        return [](int a, int b)->int {return a - b;};
    }
    else {
        return [](int a, int b)->int {return 0;};
    }
}
void main() {
    int a = 1;
    int b = 2;
    func f = getFunction("add");
    std::cout << f(a, b) << std::endl;
}

#include <functional>
#include <iostream>
typedef std::function<double(double)> FuncDouble;
double funcTest(FuncDouble f) {
    return f(10);
}

int main(void) {
    std::function<int(int)> f1 = [](int x) -> int {
        return x + 1;
    };
    std::cout << f1(10) << std::endl;
    std::cout << funcTest([](double d )->double {
        return  d * 20;
    }) << std::endl;
    return 0;
}

#include <functional>
#include <iostream>
typedef std::function<double(double)> FuncDouble;
double funcTest(FuncDouble f) {
    return f(10);
}

int main(void) {
    std::function<int(int)> f1 = [](int x) -> int {
        return x + 1;
    };
    std::cout << f1(10) << std::endl;
    double doub1 = 32;
    
    std::cout << funcTest([&](double d )->double {
        return  d * doub1;
    }) << std::endl;
    
    return 0;
}
```
---


## 9. Autoë¡œ ëŒë‹¤ì‹ ë‹¤ë£¨ê¸°

```cpp
#include <iostream>
#include <memory>

int main(){

    int a = 12;
    auto func1 = [=](int b, int c) {
        std::cout << "a = " << a << ", b = " << b << ", c = " << c << std::endl;
    };

    auto func2 = [&](int b, int c) {
        std::cout << "a = " << a << ", b = " << b << ", c = " << c << std::endl;
    };

    func1(20, 30); //a = 12, b = 20, c = 30
    func2(20, 30); //a = 12, b = 20, c = 30

    a = 24;
    func1(30, 40); //a = 12, b = 30, c = 40
    func2(30, 40); //a = 24, b = 30, c = 40

}
```

---

## 10. ì •ë¦¬

- ëŒë‹¤ëŠ” í•¨ìˆ˜ ê°ì²´ì˜ ë¬¸ë²•ì  ì„¤íƒ•(syntactic sugar)
- ì™¸ë¶€ ë³€ìˆ˜ ì ‘ê·¼ì„ ìœ„í•´ **ìº¡ì²˜** ì‚¬ìš©
- `mutable`ë¡œ ê°’ ìº¡ì²˜ ìˆ˜ì • ê°€ëŠ¥
- `throw()`ë¡œ ì˜ˆì™¸ ëª…ì‹œ ê°€ëŠ¥
- ë°˜í™˜ íƒ€ì… ì§€ì • ê°€ëŠ¥ (`-> type`)
- STL ì•Œê³ ë¦¬ì¦˜ê³¼ í•¨ê»˜ ìì£¼ ì‚¬ìš©ë¨

---

### ğŸ“š ì°¸ê³ 
- ISO C++11 í‘œì¤€
- cppreference.com
