# C++ Template Fold Expression ì •ë¦¬
## 1ï¸âƒ£ Fold Expressionì´ë€?
C++17ë¶€í„° ë„ì…ëœ Fold Expressionì€ ê°€ë³€ ì¸ì í…œí”Œë¦¿ì„ ê°„ê²°í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë¬¸ë²•ì…ë‹ˆë‹¤.
ë³µì¡í•œ ì¬ê·€ í˜¸ì¶œ ì—†ì´ ì—°ì‚°ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¸ìë“¤ì„ ì ‘ëŠ”(fold) ë°©ì‹ìœ¼ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.

## 2ï¸âƒ£ ê¸°ë³¸ ì˜ˆì œ: ëˆ„ì  í•© ê³„ì‚°
### â–¶ï¸ ì˜¤ë¥¸ìª½ Fold ((t + ...))
```cpp
template<typename... T>
auto sum(T... t) {
    return (t + ...); // ì˜¤ë¥¸ìª½ fold
}
```

- ê³„ì‚° ìˆœì„œ: t1 + (t2 + (t3 + (...)))
- ì˜¤ë¥¸ìª½ë¶€í„° ì ‘í˜
- ì¶œë ¥: sum(1,2,3,4,5,6,7,8,9,10) â†’ 55

### â–¶ï¸ ì™¼ìª½ Fold ((... + t))
template<typename... T>
auto sum(T... t) {
    return (... + t); // ì™¼ìª½ fold
}


- ê³„ì‚° ìˆœì„œ: (((t1 + t2) + t3) + ...)
- ì™¼ìª½ë¶€í„° ì ‘í˜
- ì¶œë ¥ ë™ì¼: 55

### 3ï¸âƒ£ Fold Expressionì˜ ì¢…ë¥˜
| í‘œí˜„ì‹ | ì„¤ëª… | 
|-------|------|
| (t + ...) | ì˜¤ë¥¸ìª½ fold | 
| (... + t) | ì™¼ìª½ fold | 
| (t + ... + init) | ì˜¤ë¥¸ìª½ fold with ì´ˆê¸°ê°’ | 
| (init + ... + t) | ì™¼ìª½ fold with ì´ˆê¸°ê°’ | 


ğŸ” ì´ˆê¸°ê°’ ì˜ˆì‹œ
```cpp
template<typename... T>
auto sum(T... t) {
    return (0 + ... + t); // ì™¼ìª½ fold with ì´ˆê¸°ê°’
}
```


### 4ï¸âƒ£ Fold ì—†ì´ ì¬ê·€ë¡œ êµ¬í˜„í•œ ì˜ˆ
```cpp
template<typename T>
constexpr auto tsum(T value) {
    return value;
}

template<typename T, typename... Targs>
constexpr auto tsum(T value, Targs... args) {
    return value + tsum(args...); // ì¬ê·€ í˜¸ì¶œ
}
```

- C++11ë¶€í„° ê°€ëŠ¥í•œ ë°©ì‹
- ì»´íŒŒì¼ëŸ¬ ìµœì í™”ê°€ ì˜ ë˜ì§€ë§Œ, ì½”ë“œê°€ ë³µì¡í•˜ê³  ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€
- ì¶œë ¥: tsum(1,2,3,4,5) â†’ 15

### 5ï¸âƒ£ Fold Expressionì˜ ì¥ì 
- âœ… ê°„ê²°í•œ ë¬¸ë²•
- âœ… ì»´íŒŒì¼ëŸ¬ ìµœì í™”ì— ìœ ë¦¬
- âœ… ì¬ê·€ ê¹Šì´ ì œí•œ ì—†ìŒ
- âœ… ë‹¤ì–‘í•œ ì—°ì‚°ìì— ì ìš© ê°€ëŠ¥ (+, *, &&, ||, , ë“±)

### 6ï¸âƒ£ ë‹¤ì–‘í•œ Fold í™œìš© ì˜ˆì‹œ
#### ğŸ”¢ ê³±ì…ˆ
```cpp
template<typename... T>
auto product(T... t) {
    return (1 * ... * t);
}
```

#### ğŸ” ë…¼ë¦¬ AND
```cpp
template<typename... T>
bool allTrue(T... t) {
    return (true && ... && t);
}
```

#### ğŸ“¦ ì¶œë ¥ ë‚˜ì—´
```cpp
template<typename... T>
void printAll(T... t) {
    (std::cout << ... << t) << std::endl;
}
```


## ğŸ§¾ ìš”ì•½
```cpp
| ë°©ì‹ | ë¬¸ë²• | íŠ¹ì§• | 
| ì˜¤ë¥¸ìª½ Fold | (t + ...) | ì˜¤ë¥¸ìª½ë¶€í„° ì ‘í˜ | 
| ì™¼ìª½ Fold | (... + t) | ì™¼ìª½ë¶€í„° ì ‘í˜ | 
| ì´ˆê¸°ê°’ í¬í•¨ Fold | (init + ... + t) | ì´ˆê¸°ê°’ìœ¼ë¡œ ì‹œì‘ ê°€ëŠ¥ | 
| ì¬ê·€ í…œí”Œë¦¿ | tsum(...) | C++11 ë°©ì‹, ë³µì¡í•¨ | 
```

---



# ğŸ” Fold ë°©ì‹ë³„ ì˜ˆì œ ë¶„ì„
## 1ï¸âƒ£ ë‹¨í•­ ì¢Œì¸¡ Fold (... + nums)
```cpp
template <typename... Ints>
int sum_all(Ints... nums) {
    return (... + nums); // ì¢Œì¸¡ Fold
}
```

```
- í˜¸ì¶œ: sum_all(1, 4, 2, 3, 10)
- ì „ê°œ: ((((1 + 4) + 2) + 3) + 10)
- ê²°ê³¼: 20
```

## 2ï¸âƒ£ ì´í•­ ì¢Œì¸¡ Fold (start - ... - nums)

```cpp
template <typename Int, typename... Ints>
Int diff_from(Int start, Ints... nums) {
    return (start - ... - nums); // ì¢Œì¸¡ Fold with ì´ˆê¸°ê°’
}
```

```
- í˜¸ì¶œ: diff_from(100, 1, 4, 2, 3, 10)
- ì „ê°œ: (((((100 - 1) - 4) - 2) - 3) - 10)
- ê²°ê³¼: 80
```

## 3ï¸âƒ£ ë‹¨í•­ ì¢Œì¸¡ Foldë¡œ í•¨ìˆ˜ í˜¸ì¶œ (obj.do_something(nums), ...)
```cpp
class A {
 public:
  void do_something(int x) const {
    std::cout << "Do something with " << x << std::endl;
  }
};

template <typename T, typename... Ints>
void do_many_things(const T& t, Ints... nums) {
  (t.do_something(nums), ...); // ì¢Œì¸¡ Fold
}
```


```
- í˜¸ì¶œ: do_many_things(a, 1, 3, 2, 4)
- ì „ê°œ: (((t.do_something(1), t.do_something(3)), t.do_something(2)), t.do_something(4))
- ê²°ê³¼:
Do something with 1
Do something with 3
Do something with 2
Do something with 4
```


## ğŸ” Fold Expression ë³´ê°•: ë‹¨í•­ ìš°ì¸¡ & ì´í•­ ìš°ì¸¡
```cpp
### 1ï¸âƒ£ ë‹¨í•­ ìš°ì¸¡ Fold (E op ...)
ì˜ˆì œ: sum_all_right

#include <iostream>
template <typename... Ints>
int sum_all_right(Ints... nums) {
    return (nums + ...); // ë‹¨í•­ ìš°ì¸¡ Fold
}
int main() {
    std::cout << sum_all_right(1, 4, 2, 3, 10) << std::endl;
}
```
```
- ì „ê°œ í˜•íƒœ: 1 + (4 + (2 + (3 + 10)))
- ê³„ì‚° ìˆœì„œ: ì˜¤ë¥¸ìª½ë¶€í„° ì ‘í˜
- ê²°ê³¼: 20
```

### 2ï¸âƒ£ ì´í•­ ìš°ì¸¡ Fold (E op ... op I)
ì˜ˆì œ: diff_to
```cpp
#include <iostream>
template <typename... Ints>
int diff_to(Ints... nums) {
    return (nums - ... - 100); // ì´í•­ ìš°ì¸¡ Fold
}
int main() {
    std::cout << diff_to(1, 4, 2, 3, 10) << std::endl;
}
```

```
- ì „ê°œ í˜•íƒœ: 1 - (4 - (2 - (3 - (10 - 100))))
- ê³„ì‚° ìˆœì„œ: ì˜¤ë¥¸ìª½ë¶€í„° ì ‘í˜
- ê²°ê³¼: 1 - (4 - (2 - (3 - (10 - 100)))) = 1 - (4 - (2 - (3 - (-90)))) = ... = ìµœì¢… ê²°ê³¼
```

ì´í•­ ìš°ì¸¡ FoldëŠ” ì´ˆê¸°ê°’ì´ ë§ˆì§€ë§‰ì— ìœ„ì¹˜í•˜ë©°, ì—°ì‚°ì´ ì˜¤ë¥¸ìª½ë¶€í„° ì§„í–‰ë©ë‹ˆë‹¤.



## ğŸ§¾ ì¬ê·€ í…œí”Œë¦¿ê³¼ ë¹„êµ
```cpp
template<typename Arg>
void print_all(const Arg& arg){
    std::cout << arg << std::endl;
}

template<typename Arg, typename ...Args>
void print_all(const Arg& arg, const Args&... args){
    std::cout << arg << ',';
    print_all(args...); // ì¬ê·€ í˜¸ì¶œ
}
```

```
- í˜¸ì¶œ: print_all(1, 2, 3, 4, 5)
- ì¶œë ¥: 1,2,3,4,5
```

## ğŸ†š Fold Expressionìœ¼ë¡œ ë°”ê¾¸ë©´:
```cpp
template<typename... Args>
void print_all_fold(const Args&... args){
    ((std::cout << args << ','), ...);
    std::cout << std::endl;
}
```

- ë” ê°„ê²°í•˜ê³  ìœ ì§€ë³´ìˆ˜ ì‰¬ì›€!

## âœ… ìš”ì•½

| ë°©ì‹ | ë¬¸ë²• | ì „ê°œ ë°©í–¥ | íŠ¹ì§• |
|------|-----|----------|------| 
| ë‹¨í•­ ìš°ì¸¡ Fold | (E op ...) | ì˜¤ë¥¸ìª½ | ë§ˆì§€ë§‰ë¶€í„° ì ‘í˜ | 
| ë‹¨í•­ ì¢Œì¸¡ Fold | (... op E) | ì™¼ìª½ | ì²˜ìŒë¶€í„° ì ‘í˜ | 
| ì´í•­ ìš°ì¸¡ Fold | (E op ... op I) | ì˜¤ë¥¸ìª½ | ì´ˆê¸°ê°’ì´ ë§ˆì§€ë§‰ì— ìœ„ì¹˜ | 
| ì´í•­ ì¢Œì¸¡ Fold | (I op ... op E) | ì™¼ìª½ | ì´ˆê¸°ê°’ì´ ì²˜ìŒì— ìœ„ì¹˜ | 

---





