# 🧠 C++ 대입 연산자와 복사 생성자 심화 정리

## 📌 1. 기본 개념
| 항목 | 설명 | 호출 시점 |
|------|----|-----------| 
| 복사 생성자 | 객체 생성 시, 다른 객체로 초기화 | Person p = other; 또는 Person p(other); | 
| 대입 연산자 | 이미 생성된 객체에 다른 객체를 대입 | p1 = p2; | 



## 🔧 2. 코드 분석
```cpp
class Person {
public:
    int age = 20;

    Person() { age = 20; }

    Person(Person& other) {
        std::cout << "Copy Constructor called" << std::endl;
        age = other.age;
    }

    Person& operator=(Person& other) {
        std::cout << "Operator= called" << std::endl;
        age = other.age;
        return *this;
    }
};


int main() {
    Person person1;
    Person person2;
    person2.age = 50;

    person1 = person2;       // 대입 연산자 호출
    Person person = person2; // 복사 생성자 호출
}
```


## 🔍 3. 호출 시점 요약
| 상황 | 호출되는 함수 | 
|------|-------------|
| 객체 생성 + 초기화 | 복사 생성자 | 
| 기존 객체에 대입 | 대입 연산자 | 
| 함수 인자로 전달 (값) | 복사 생성자 | 
| 함수 반환값으로 전달 | 복사 생성자 (RVO 최적화 가능) | 



## 🧪 4. 깊은 복사 vs 얕은 복사
### 얕은 복사 (Shallow Copy)
- 포인터 멤버를 그대로 복사
- 동일한 메모리를 공유 → 위험
### 깊은 복사 (Deep Copy)
- 포인터 멤버를 새로운 메모리에 복사
- 안전한 복사
```cpp
class Person {
    char* name;
public:
    Person(const char* n) {
        name = new char[strlen(n) + 1];
        strcpy(name, n);
    }

    Person(const Person& other) { // 깊은 복사
        name = new char[strlen(other.name) + 1];
        strcpy(name, other.name);
    }

    Person& operator=(const Person& other) {
        if (this != &other) {
            delete[] name;
            name = new char[strlen(other.name) + 1];
            strcpy(name, other.name);
        }
        return *this;
    }

    ~Person() {
        delete[] name;
    }
};
```


## 🧨 5. Rule of Three
만약 클래스가 소멸자, 복사 생성자, 대입 연산자 중 하나라도 정의한다면,
나머지 둘도 반드시 정의해야 한다.

| 구성 요소 | 역할 |
|----------|-------| 
| 소멸자 | 동적 메모리 해제 | 
| 복사 생성자 | 객체 생성 시 복사 | 
| 대입 연산자 | 기존 객체에 복사 | 



## 🧠 6. Modern C++ 확장: Rule of Five
C++11 이후에는 **이동 생성자(move constructor)** 와 **이동 대입 연산자(move assignment)** 까지 포함

| 구성 요소 | 설명 |
|----------|-----| 
| 복사 생성자 | Person(const Person&) | 
| 복사 대입 연산자 | Person& operator=(const Person&) | 
| 이동 생성자 | Person(Person&&) | 
| 이동 대입 연산자 | Person& operator=(Person&&) | 
| 소멸자 | ~Person() | 



## ✅ 마무리 요약
| 항목 | 복사 생성자 | 대입 연산자 |
|------|-----------|-----------| 
| 호출 시점 | 객체 생성 시 | 기존 객체에 대입 | 
| 반환 타입 | 없음 | 참조 (*this) | 
| 깊은 복사 구현 | 필요 | 필요 | 
| Rule of Three | 반드시 함께 구현 | 반드시 함께 구현 | 

----


