# ğŸ“˜ C++11 í•¨ìˆ˜ í•©ì„± ì„¤ëª… ë¬¸ì„œ (Compose)

## ğŸ” ê°œìš”
ì´ ë¬¸ì„œëŠ” C++11ì˜ ëŒë‹¤ í‘œí˜„ì‹ê³¼ std::functionì„ í™œìš©í•˜ì—¬ í•¨ìˆ˜ í•©ì„±ì„ êµ¬í˜„í•œ ì½”ë“œì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.
í•¨ìˆ˜ í•©ì„±ì´ë€, ë‘ í•¨ìˆ˜ë¥¼ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.
ì˜ˆ: f(g(x))

## ğŸ“¦ ì½”ë“œ ì „ë¬¸
```cpp
#include <iostream>
#include <functional>
using namespace std;

auto compose = [](auto f, auto g) {
    return [=](auto... args) {
        return f(g(args...));
    };
};

int main()
{
    cout << compose(::negate{}, ::multiplies{})(4, 6);
}
```


## ğŸ§  í•µì‹¬ êµ¬ì„± ìš”ì†Œ ì„¤ëª…
### 1. compose ëŒë‹¤
```cpp
auto compose = [](auto f, auto g) {
    return [=](auto... args) {
        return f(g(args...));
    };
};
```

- ì…ë ¥: ë‘ í•¨ìˆ˜ f, g
- ì¶œë ¥: f(g(args...)) í˜•íƒœì˜ ìƒˆë¡œìš´ í•¨ìˆ˜
- auto... args: ê°€ë³€ ì¸ì í…œí”Œë¦¿ìœ¼ë¡œ ì—¬ëŸ¬ ì¸ìë¥¼ ë°›ì„ ìˆ˜ ìˆìŒ
- [=]: ìº¡ì²˜ by-valueë¡œ f, gë¥¼ ë‚´ë¶€ ëŒë‹¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•¨
ğŸ“Œ ì´ ëŒë‹¤ëŠ” ê³ ì°¨ í•¨ìˆ˜ë¡œ, í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ë°›ê³  í•¨ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

### 2. ::negate{} ì™€ ::multiplies{}
ì´ ë‘˜ì€ <functional> í—¤ë”ì— ì •ì˜ëœ **í•¨ìˆ˜ ê°ì²´(function object)**ì…ë‹ˆë‹¤.
| í•¨ìˆ˜ ê°ì²´ | ì—­í•  | ì˜ˆì‹œ ê²°ê³¼ |
|----------|------|---------| 
| std::multiplies<int>() | ë‘ ê°’ì„ ê³±í•¨ | 4 * 6 = 24 | 
| std::negate<int>() | ê°’ì„ ìŒìˆ˜ë¡œ ë°”ê¿ˆ | -24 | 


### 3. compose(::negate{}, ::multiplies{})
- composeë¥¼ í†µí•´ negate(multiplies(x, y)) í˜•íƒœì˜ í•©ì„± í•¨ìˆ˜ ìƒì„±
- compose(f, g)(x, y) â†’ f(g(x, y))
ì¦‰, compose(::negate{}, ::multiplies{})(4, 6)ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤:
```cpp
std::multiplies<int>()(4, 6) â†’ 24  
std::negate<int>()(24) â†’ -24
```


#### âœ… ì‹¤í–‰ ê²°ê³¼
-24



## ğŸ“Œ í™•ì¥ ì˜ˆì‹œ
ë‹¤ì–‘í•œ í•¨ìˆ˜ ê°ì²´ë¥¼ ì¡°í•©í•˜ë©´ ë” ë³µì¡í•œ ë¡œì§ë„ ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```cpp
auto square = [](int x) { return x * x; };
auto double_then_square = compose(square, [](int x) { return x * 2; });
cout << double_then_square(5); // ì¶œë ¥: 100
```
ì´ ë°©ì‹ì€ auto ëŒë‹¤ì™€ ê±°ì˜ ë™ì¼í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ë©´ì„œ, std::functionë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ê³  íƒ€ì… ì¶”ë¡ ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```cpp
#include <iostream>
#include <functional>

// compose í•¨ìˆ˜ ì •ì˜

std::function<int(int, int)> compose(
    std::function<int(int)> f,
    std::function<int(int, int)> g)
{
    return [=](int x, int y) {
        return f(g(x, y));
    };
}

int main() {
    // g(x, y) = x + y
    std::function<int(int, int)> add = [](int a, int b) {
        return a + b;
    };

    // f(z) = z * z
    std::function<int(int)> square = [](int z) {
        return z * z;
    };

    // í•©ì„± í•¨ìˆ˜ ìƒì„±
    auto composed = compose(square, add);

    // í…ŒìŠ¤íŠ¸
    int result = composed(3, 4); // (3 + 4)^2 = 49
    std::cout << "Result: " << result << std::endl;

    return 0;
}
```


## ğŸ§© í…œí”Œë¦¿ ë²„ì „ (ë” ì¼ë°˜ì ì´ê³  ê°•ë ¥í•¨)
```cpp
template <typename F, typename G>
auto compose(F f, G g) {
    return [=](auto... args) {
        return f(g(args...));
    };
}
```

### í…œí”Œë¦¿ ë²„ì „ ì˜ˆì œ
```cpp

#include <iostream>
#include <string>

// compose í…œí”Œë¦¿ í•¨ìˆ˜
template <typename F, typename G>
auto compose(F f, G g) {
    return [=](auto... args) {
        return f(g(args...));
    };
}

int main() {
    // g(x, y) = x + y
    auto add = [](int a, int b) {
        return a + b;
    };

    // f(z) = "ê²°ê³¼ëŠ” " + z + "ì…ë‹ˆë‹¤"
    auto to_string_with_message = [](int result) {
        return "ê²°ê³¼ëŠ” " + std::to_string(result) + "ì…ë‹ˆë‹¤";
    };

    // í•©ì„± í•¨ìˆ˜ ìƒì„±
    auto composed = compose(to_string_with_message, add);

    // í…ŒìŠ¤íŠ¸
    std::cout << composed(3, 4) << std::endl; // ì¶œë ¥: ê²°ê³¼ëŠ” 7ì…ë‹ˆë‹¤

    return 0;
}

int main() {
    // g: ë¬¸ìì—´ì„ ì†Œë¬¸ìë¡œ ë³€í™˜
    auto to_lower = [](std::string s) {
        std::transform(s.begin(), s.end(), s.begin(), ::tolower);
        return s;
    };

    // f: ë¬¸ìì—´ ê¸¸ì´ ë°˜í™˜
    auto length = [](const std::string& s) {
        return s.length();
    };

    // í•©ì„±: ë¬¸ìì—´ â†’ ì†Œë¬¸ì â†’ ê¸¸ì´
    auto get_lower_length = compose(length, to_lower);

    std::string input = "HelloWorld";
    std::cout << "ì†Œë¬¸ì ê¸¸ì´: " << get_lower_length(input) << std::endl;

    return 0;
}
//ì†Œë¬¸ì ê¸¸ì´: 10



// g: ë‘ ìˆ«ìë¥¼ ë”í•¨
auto add = [](int a, int b) { return a + b; };

// f: ê²°ê³¼ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
auto to_string = [](int x) { return std::to_string(x); };

// compose: f(g(x, y)) í˜•íƒœë¡œ í•©ì„±
auto composed = compose(to_string, add);


```




## ğŸ§© ìš”ì•½
| í•­ëª© | ì„¤ëª… |
|------|-----| 
| compose | ë‘ í•¨ìˆ˜ë¥¼ í•©ì„±í•˜ì—¬ ìƒˆë¡œìš´ í•¨ìˆ˜ ìƒì„± | 
| std::negate | ê°’ì„ ìŒìˆ˜ë¡œ ë°”ê¾¸ëŠ” í•¨ìˆ˜ ê°ì²´ | 
| std::multiplies | ë‘ ê°’ì„ ê³±í•˜ëŠ” í•¨ìˆ˜ ê°ì²´ | 
| í•µì‹¬ ê°œë… | ê³ ì°¨ í•¨ìˆ˜, ëŒë‹¤ í‘œí˜„ì‹, í•¨ìˆ˜ ê°ì²´ í™œìš© | 

----


# ğŸ§  C++ì—ì„œ pipeline êµ¬í˜„í•˜ê¸°
C++ì—ì„œëŠ” í…œí”Œë¦¿ê³¼ ëŒë‹¤ë¥¼ í™œìš©í•´ì„œ ë¹„ìŠ·í•œ êµ¬ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.

## ğŸ”§ ê¸°ë³¸ pipeline í•¨ìˆ˜
template <typename... Funcs>
auto pipeline(Funcs... funcs) {
    return [=](auto input) {
        return ( ... | [=](auto val) { return funcs(val); } )(input);
    };
}


í•˜ì§€ë§Œ ì´ê±´ C++20ì˜ operator| ì˜¤ë²„ë¡œë”©ì´ í•„ìš”í•´ì„œ ë³µì¡í•´ì§ˆ ìˆ˜ ìˆì–´ìš”.
ê·¸ë˜ì„œ ì‹¤ì „ì—ì„œëŠ” ë‹¨ìˆœí•œ compose ì²´ì¸ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê²Œ ë” ì¼ë°˜ì ì´ì—ìš”.

## âœ… ì‹¤ì „ ì˜ˆì œ: composeë¡œ pipeline êµ¬ì„±
```cpp
#include <iostream>
#include <string>
#include <algorithm>

// compose í•¨ìˆ˜
template <typename F, typename G>
auto compose(F f, G g) {
    return [=](auto... args) {
        return f(g(args...));
    };
}

// pipeline í•¨ìˆ˜: ì—¬ëŸ¬ í•¨ìˆ˜ ì—°ê²°


template <typename F, typename... Rest>
auto pipeline(F f, Rest... rest) {
    if constexpr (sizeof...(rest) == 0) {
        return f;
    } else {
        return compose(pipeline(rest...), f);
    }
}

int main() {

    auto trim = [](std::string s) {
        auto new_end = std::remove_if(s.begin(), s.end(), [](unsigned char c) {
        return std::isspace(c);
        });
        s.erase(new_end, s.end());
        return s;
    };

    auto to_upper = [](std::string s) {
        std::transform(s.begin(), s.end(), s.begin(), ::toupper);
        return s;
    };

    auto add_prefix = [](std::string s) {
        return "[ë³€í™˜ë¨] " + s;
    };

    auto process = pipeline(add_prefix, to_upper, trim);

    std::string input = "   Hello World   ";
    std::cout << process(input) << std::endl; // ì¶œë ¥: [ë³€í™˜ë¨]HELLOWORLD

    return 0;
}
```


## ğŸ” í•µì‹¬ ìš”ì•½
| êµ¬ì„± ìš”ì†Œ | ì„¤ëª… | 
|----------|-----|
| compose(f, g) | f(g(...)) í˜•íƒœë¡œ í•¨ìˆ˜ í•©ì„± | 
| pipeline(f1, f2, f3) | f3(f2(f1(x))) í˜•íƒœë¡œ í•¨ìˆ˜ ì—°ê²° | 
| ëŒë‹¤ í•¨ìˆ˜ë“¤ | ê°ê°ì˜ ì²˜ë¦¬ ë‹¨ê³„ (ì˜ˆ: trim â†’ to_upper â†’ add_prefix) | 


---




